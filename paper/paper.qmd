---
title: "Voting"
author: "Emily Su"
thanks: "Data and code are available at: https://github.com/moonsdust/toronto-collisions. The replication on the Social Science Reproduction platform can be found here: https://www.socialsciencereproduction.org/reproductions/c0db16d9-e70e-4bbc-85d2-f7137a0e8c47/index"
date: today
date-format: "YYYY MMMM D"
abstract: "Abstract."
format:
  pdf:
    toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false
#### Preamble ####
# Purpose: To create graphs and analyze data based on data from "Who Does Voter ID Keep from Voting?" (Fraga and Miller 2022)"
# Author: Emily Su
# Email: em.su@mail.utoronto.ca
# Date: 13 February 2024
# Prerequisites: All the scripts in the scripts folder have been ran starting from 00-install_packages.R.

#### Workspace setup ####
library(tidyverse) # Contains data-related packages
library(knitr) # To make tables
library(janitor) # To clean datasets
library(dplyr)
library(ggplot2) # To make graphs
library(sf) # For making maps
library(readr)
```

```{r}
#| include: false # Would run the code but it will have no output and code is not in the document 
#| warning: false # Warnings are not included 
#| message: false # Messages are not included 

# Read in data
cleaned_reason_data <- read_csv("../data/analysis_data/cleaned_reason_data.csv", show_col_types = FALSE)

# Texas County data
texas_county <- read_csv("../data/analysis_data/cleaned_map_data.csv", show_col_types = FALSE)
cleaned_map_data <- st_as_sf(texas_county, wkt = "the_geom")
```

# Introduction



# Data {#sec-data}

The datasets were retrieved, simulated, cleaned, analyzed, and tested using the `R` programming language [@citeR], `tidyverse` [@citetidyverse], `haven` [@citehaven], `knitr` [@citeknitr], `janitor` [@citejanitor], `dplyr` [@citedplyr], `ggplot2` [@citeggplot2], `sf` [@citesf], `readr` [@citereadr], and `dataverse` [@citedataverse]. 

# Results {#sec-result}
```{r}
#| label: fig-votermap
#| fig-cap: Number of voters across Texas counties during 2016 United States election without proper ID
#| echo: false
#| warning: false
#| message: false

# Referenced to figure out how to create map: https://roelandtn.frama.io/cours_r_pdm/mapping-with-r-and-sf.html
ggplot(cleaned_map_data) + 
  geom_sf(aes(fill = count)) + 
  theme_minimal() + 
  labs(
    x = "Longitude",
    y = "Latitude",
    title = "Number of 2016 US election voters across Texas counties without proper ID",
    subtitle = "Counties with labels have more than or equal to 500 voters without IDs",
    fill = "Number of voters"
    ) +
  # Changes the font of the title and removes the x and y axis 
  # Reference to figured out how to add labels to maps https://tmieno2.github.io/R-as-GIS-for-Economists/create-maps.html
  geom_sf_text(
    # Referenced code to figure out how to only show labels with certain values     
    # https://r-graph-gallery.com/275-add-text-labels-with-ggplot2.html 
    data = cleaned_map_data |> filter(count>=500),
    # Label is county name
    aes(label = county),
    check_overlap = TRUE,
    size = 2, 
    color = "pink"
    ) +
    theme(plot.title = element_text(size = 9, face = 'bold'), 
          plot.subtitle = element_text(size = 9),
          rect = element_blank(), 
          axis.text.x = element_blank(), 
          axis.text.y = element_blank(), 
          axis.ticks = element_blank(), 
          legend.title = element_text(size = 8),
          panel.grid.major = element_blank(),
          panel.grid.minor = element_blank()
          ) 
```

# Discussion


\newpage

\appendix

# Appendix {-}

## Acknowledgments 
We would like to acknowledge @citetellingstorieswithdata for some of the R code used in this paper to produce the tables and graphs. 

## Datasets Used {#sec-datasetused}
Due to the length of the datasets horizontally, presenting glimpses of the datasets was not possible in the paper. However, the cleaned datasets that was used can be found here: https://github.com/moonsdust/voting/tree/main/data/analysis_data.

## Tables from Results {#sec-tablesfromresults}
```{r}
#| label: tbl-votermap
#| tbl-cap: Number of United States election voters across Texas counties in 2016 without proper ID
#| echo: false
#| warning: false
#| message: false

texas_county |>
  select(county, count) |>
  arrange(desc(count)) |>
  rename(
    "Number of Voters" = count,
    "County" = county
  ) |>
  kable()
```

\newpage


# References


